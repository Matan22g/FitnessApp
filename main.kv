#: include kv/homescreen.kv
#: include kv/loginscreen.kv
#: include kv/settingsscreen.kv
#: include kv/friends.kv
#: include kv/workouts.kv
#: include FirebaseLoginScreen/firebaseloginscreen.kv
#: import Snackbar kivymd.uix.snackbar.Snackbar

NavigationLayout:
    id: nav_layout

    ScreenManager:

        id: screen_manager

        FirebaseLoginScreen:
            id: firebase_login_screen
            name: "loginscreen"
            web_api_key: "AIzaSyB2OZaUuFaqCWDd9GX_Gt1lRdHF8H6ueHo"
            on_login_success:
                app.change_screen("main_app_screen")
                Snackbar(text="Logged in!").show()
                app.localId = self.localId
                app.idToken = self.idToken



        Screen:
            name: "main_app_screen"
            BoxLayout:
                orientation: 'vertical'

                MDToolbar:
                    title: "Hello Matan"
                    elevation: 10
                    left_action_items: [['menu', lambda x: nav_drawer.set_state()]]
                ScreenManager:
                    id: screen_manager1

                    HomeScreen:
                        id: homescreen
                        name: "homescreen"

                    WorkoutsScreen:
                        id: workoutsscreen
                        name: "workoutsscreen"

                    FriendsScreen:
                        id: friendsscreen
                        name: "friendsscreen"

                    SettingsScreen:
                        id: settingsscreen
                        name: "settingsscreen"




    MDNavigationDrawer:
        id: nav_drawer
        width: "175dp"
        BoxLayout:
            orientation: "vertical"
            padding: "4dp"
            spacing: "10dp"

            Image:
                source: "resources/logo.png"
                size_hint_y: None
                size: "95dp", "95dp"


            ScrollView:

                MDList:

                    OneLineIconListItem:
                        text: "Home"
                        on_release:
                            screen_manager1.current = "homescreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "home"

                    OneLineIconListItem:
                        text: "Friends"
                        on_release:
                            screen_manager1.current = "friendsscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "account-group"

                    OneLineIconListItem:
                        text: "Workouts"
                        on_release:
                            screen_manager1.current = "workoutsscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "weight-lifter"

                    OneLineIconListItem:
                        text: "Log Out"
                        on_release:
                            screen_manager.transition.direction = 'right'
                            firebase_login_screen.save_refresh_token("")
                            Snackbar(text="Logged out!").show()
                            screen_manager.current = "loginscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "login"

                    OneLineIconListItem:
                        text: "Settings"
                        on_release:
                            screen_manager1.current = "settingsscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "settings"




