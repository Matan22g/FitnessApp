#: include kv/homescreen.kv
#: include kv/settingsscreen.kv
#: include kv/blankscreen.kv
#: include kv/workoutsscreen.kv
#: include kv/sessionscreen.kv
#: include kv/exercisescreen.kv
#: include kv/workoutscreen.kv
#: include kv/exercise_sessions_screen.kv
#: include kv/previous_workouts_screen.kv

#: include FirebaseLoginScreen/firebaseloginscreen.kv
#:import Snackbar kivymd.uix.snackbar.Snackbar

<AddWorkoutContent>
    orientation: "vertical"
    spacing: "20dp"
    size_hint_y: None
    height: "33dp"
    MDTextField:
        hint_text: "Workout name"
        required: True
        helper_text_mode: "on_error"
        helper_text: "Enter valid name - English letters"
        input_filter: app.proper_input_filter

NavigationLayout:
    id: nav_layout
    ScreenManager:
        id: screen_manager

        FirebaseLoginScreen:
            id: firebase_login_screen
            name: "loginscreen"
            web_api_key: "AIzaSyB2OZaUuFaqCWDd9GX_Gt1lRdHF8H6ueHo"
            on_login_success:
                app.root= nav_layout
                app.change_screen("main_app_screen")
                nav_drawer.swipe_edge_width=20
                Snackbar(text="Logged in!").show()
                app.localId = self.localId
                app.idToken = self.idToken
                app.on_login()


        Screen:
            name: "main_app_screen"
            BoxLayout:
                id: main_layout
                orientation: 'vertical'
#                canvas:
#                    Rectangle:
#                        id: top_canvas
#                        pos: 0,app.window_size[1]/1.23
#                        size: self.size[0],self.size[1]/5
#                        source: "resources/loginback1.png"
#                    Rectangle:
#                        id: bottom_canvas
#                        pos: self.pos
#                        size: self.size[0],self.size[1]/8
#                        source: "resources/loginback1.png"

                CustomMDToolbar:
                    id: toolbar
                    title: "Hello Matan"
                    elevation: 0
                    right_action_items: [['menu', lambda x: nav_drawer.set_state()]]
                    left_action_items: [["chevron-left", lambda x: app.back_to_last_screen()]]
                    size_hint_y: 0.075
                    round : "100dp"


                ScreenManager:
                    id: screen_manager1

                    HomeScreen:
                        id: homescreen
                        name: "homescreen"

                    WorkoutsScreen:
                        id: workoutsscreen
                        name: "workoutsscreen"


                    SessionScreen:
                        id: sessionscreen
                        name: "sessionscreen"

                    ExerciseScreen:
                        id: exercisescreen
                        name: "exercisescreen"

                    ExerciseSessionsScreen:
                        id: exercise_sessions_screen
                        name: "exercise_sessions_screen"

                    BlankScreen:
                        id: blankscreen
                        name: "blankscreen"

                    SettingsScreen:
                        id: settingsscreen
                        name: "settingsscreen"

                    WorkoutScreen:
                        id: workoutscreen
                        name: "workoutscreen"

                    PreviousWorkoutsScreen:
                        id: previous_workouts_screen
                        name: "previous_workouts_screen"



    MDNavigationDrawer:
        id: nav_drawer
        anchor: "right"
        size_hint_x: 0.6

        BoxLayout:
            orientation: "vertical"
            padding: "4dp"
            spacing: "10dp"

            Image:
                source: "resources/logo.png"
                size_hint_y: None
                size: "95dp", "95dp"


            ScrollView:

                MDList:

                    OneLineIconListItem:
                        text: "Home"
                        on_release:
                            app.change_screen1("homescreen")
#                            screen_manager1.current = "homescreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "home"

                    OneLineIconListItem:
                        text: "Friends"
                        on_release:
                            app.change_screen1("blankscreen")
#                            screen_manager1.current = "friendsscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "account-group"

                    OneLineIconListItem:
                        text: "Previous Workouts"
                        on_release:
                            app.change_screen1("previous_workouts_screen")
#                            screen_manager1.current = "workoutsscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "calendar-clock"

                    OneLineIconListItem:
                        text: "Workouts"
                        on_release:
                            app.change_screen1("workoutsscreen")
#                            screen_manager1.current = "workoutsscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "dumbbell"

                    OneLineIconListItem:
                        text: "Log Out"
                        on_release:
                            nav_drawer.swipe_edge_width=-2
                            screen_manager.transition.direction = 'right'
                            firebase_login_screen.login_success = "False"
                            firebase_login_screen.save_refresh_token("")
                            Snackbar(text="Logged out!").show()
                            app.change_screen("loginscreen")
#                            screen_manager.current = "loginscreen"
                            nav_drawer.set_state()
                            print(nav_drawer.swipe_edge_width)
                        IconLeftWidget:
                            icon: "login"

                    OneLineIconListItem:
                        text: "Settings"
                        on_release:
                            app.change_screen1("settingsscreen")
#                            screen_manager1.current = "settingsscreen"
                            nav_drawer.set_state()
                        IconLeftWidget:
                            icon: "cog"




